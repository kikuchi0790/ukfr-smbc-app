# コードレビュー依頼

## レビュー依頼文（コピー用）

```
英国財務報告（UKFR）学習アプリケーションのコードレビューをお願いします。

最近、教材ビューアとハイライト機能を完全に再実装しました。
特に以下の観点からレビューをお願いします：

1. セキュリティ（APIキー管理、XSS対策、データ保護）
2. パフォーマンス（大量データ処理、メモリ管理）
3. アーキテクチャ（設計の妥当性、拡張性）
4. エラーハンドリング（堅牢性、ユーザビリティ）
5. コード品質（可読性、保守性、テスタビリティ）

詳細なコンテキストは以下のファイルにまとめています：
- REVIEW_CONTEXT.md: プロジェクト全体の説明と変更内容
- REVIEW_FILES_LIST.md: レビュー対象ファイルの優先順位リスト

改善提案は以下の形式でお願いします：
- 【必須】セキュリティや重大なバグに関する修正
- 【推奨】パフォーマンスや保守性の改善
- 【任意】より良いコード品質のための提案

具体的なコード例を含めた実践的な提案を期待しています。
```

## レビュー実施時の追加情報提供

レビュアーから特定のファイルの内容を求められた場合、以下の形式で提供：

```markdown
## ファイル: [ファイルパス]

\`\`\`typescript
[ファイル内容]
\`\`\`

### このファイルの役割
[簡潔な説明]

### 関連ファイル
- [関連ファイル1]
- [関連ファイル2]
```

## レビュー結果の整理方法

レビュー結果を受け取ったら、以下の形式で整理：

### 1. 必須対応項目
- [ ] セキュリティ問題1
- [ ] セキュリティ問題2
- [ ] 重大なバグ1

### 2. 推奨対応項目
- [ ] パフォーマンス改善1
- [ ] アーキテクチャ改善1
- [ ] エラーハンドリング改善1

### 3. 任意対応項目
- [ ] コード品質改善1
- [ ] リファクタリング提案1

### 4. 実装計画
1. 必須項目を最優先で実装
2. 推奨項目を段階的に実装
3. 任意項目は時間があれば実装

## 質問への回答準備

よくある質問と回答：

**Q: なぜFirestore同期を削除したのか？**
A: 複雑性とVercel KV依存により開発が困難だったため。MVPとしてLocalStorageで実装し、将来的に再実装予定。

**Q: なぜNEXT_PUBLIC_でAPIキーを管理しているのか？**
A: クライアントサイドでGemini APIを呼び出す必要があるため。サーバーサイドのプロキシ実装も検討中。

**Q: Shadow DOMを削除した理由は？**
A: 実装が複雑でメンテナンスが困難、かつ期待した隔離効果が得られなかったため。

**Q: テストカバレッジが低い理由は？**
A: 機能の再実装を優先したため。次フェーズでテスト拡充予定。

**Q: パフォーマンス測定は行ったか？**
A: 基本的な動作確認のみ。本番環境でのプロファイリングは未実施。